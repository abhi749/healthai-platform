<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthAI - Privacy-First Health Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        .upload-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .processing-animation {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
        }
        
        .gradient-orange {
            background: linear-gradient(135deg, #F59E0B 0%, #EF4444 100%);
        }
        
        .tab {
            display: none;
        }
        
        .tab.active {
            display: block;
        }
        
        .nav-button {
            transition: all 0.3s ease;
        }
        
        .nav-button.active {
            border-bottom: 2px solid #3B82F6;
            color: #3B82F6;
        }
        
        .nav-button:not(.active) {
            border-bottom: 2px solid transparent;
            color: #6B7280;
        }
        
        .nav-button:not(.active):hover {
            color: #374151;
            border-bottom-color: #D1D5DB;
        }
        
        .file-drop {
            border: 2px dashed #D1D5DB;
            transition: all 0.3s ease;
        }
        
        .file-drop.dragover {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }
        
        .file-drop.processing {
            border-color: #10B981;
            background-color: #ECFDF5;
        }
        
        .metric-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .hidden {
            display: none !important;
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center mr-3">
                            <svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                        </div>
                        <h1 class="text-2xl font-bold text-gray-900">HealthAI</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center text-sm text-gray-500">
                            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                            Privacy Protected
                        </div>
                        <div class="flex items-center text-sm text-gray-500">
                            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                            </svg>
                            <span id="doc-count">0</span> Documents
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="switchTab('upload')" id="nav-upload" class="nav-button active flex items-center px-3 py-4 text-sm font-medium">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        Upload
                    </button>
                    <button onclick="switchTab('results')" id="nav-results" class="nav-button flex items-center px-3 py-4 text-sm font-medium">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                        Results
                    </button>
                    <button onclick="switchTab('trends')" id="nav-trends" class="nav-button flex items-center px-3 py-4 text-sm font-medium">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                        Trends
                    </button>
                    <button onclick="switchTab('risk')" id="nav-risk" class="nav-button flex items-center px-3 py-4 text-sm font-medium">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        Risk Assessment
                    </button>
                    <button onclick="switchTab('history')" id="nav-history" class="nav-button flex items-center px-3 py-4 text-sm font-medium">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        History
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Upload Tab -->
            <div id="tab-upload" class="tab active">
                <div class="max-w-4xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">Upload Your Health Documents</h2>
                        <p class="text-lg text-gray-600">
                            Drag and drop your lab reports for instant AI analysis
                        </p>
                    </div>

                    <div id="file-drop-zone" class="file-drop rounded-lg p-8 text-center">
                        <div id="upload-content">
                            <svg class="h-12 w-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            <h3 class="text-xl font-semibold text-gray-900 mb-2">Choose files or drag and drop</h3>
                            <p class="text-gray-500 mb-4">PDF documents up to 25MB each</p>
                            <input type="file" multiple accept=".pdf" id="file-input" class="hidden">
                            <label for="file-input" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 cursor-pointer">
                                Select Files
                            </label>
                        </div>

                        <div id="processing-content" class="hidden">
                            <div class="processing-animation inline-block mb-4">
                                <svg class="h-12 w-12 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 mb-2">AI Processing Your Health Data</h3>
                            <p class="text-gray-600 mb-4">Analyzing patterns and generating insights...</p>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div id="progress-bar" class="bg-blue-600 h-2 rounded-full progress-bar" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-gray-500"><span id="progress-text">0</span>% Complete</p>
                        </div>
                    </div>

                    <div class="mt-8 bg-green-50 border border-green-200 rounded-lg p-6">
                        <div class="flex items-start">
                            <svg class="h-6 w-6 text-green-600 mr-3 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                            <div>
                                <h4 class="text-lg font-semibold text-green-800 mb-2">Your Privacy is Protected</h4>
                                <ul class="text-sm text-green-700 space-y-1">
                                    <li>• All processing happens locally in your browser</li>
                                    <li>• Personal identifiers are automatically removed</li>
                                    <li>• No health data is sent to external servers</li>
                                    <li>• Analysis results are stored securely on your device</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Tab -->
            <div id="tab-results" class="tab">
                <div id="no-results" class="text-center py-12">
                    <svg class="h-12 w-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">No Analysis Results</h3>
                    <p class="text-gray-500">Upload a health document to see AI-generated insights</p>
                </div>
                <div id="results-content" class="hidden"></div>
            </div>

            <!-- Trends Tab -->
            <div id="tab-trends" class="tab">
                <div class="text-center py-8">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                    </svg>
                    <p class="text-gray-500 mt-2">Upload at least 2 documents to see trends</p>
                </div>
            </div>

            <!-- Risk Tab -->
            <div id="tab-risk" class="tab">
                <div class="text-center py-8">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    <p class="text-gray-500 mt-2">Upload health documents to see risk assessment</p>
                </div>
            </div>

            <!-- History Tab -->
            <div id="tab-history" class="tab">
                <div id="no-history" class="text-center py-8">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <p class="text-gray-500 mt-2">No documents uploaded yet</p>
                </div>
                <div id="history-content" class="hidden"></div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white border-t mt-auto">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex justify-between items-center text-sm text-gray-500">
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center">
                            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            Sub-3s Analysis
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                            100% Private
                        </div>
                        <div class="flex items-center">
                            <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                            AI-Powered
                        </div>
                    </div>
                    <div>
                        © 2024 HealthAI. Privacy-first health analysis.
                    </div>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>

<script>
// Global variables
let healthData = [];
let isProcessing = false;

// Initialize when page loads
window.addEventListener('load', function() {
    console.log('Page loaded, initializing HealthAI...');
    loadHealthData();
    updateDocumentCount();
    setupEventHandlers();
});

// Setup all event handlers
function setupEventHandlers() {
    // File input handler
    const fileInput = document.getElementById('file-input');
    if (fileInput) {
        fileInput.addEventListener('change', function(e) {
            console.log('File input changed, files:', e.target.files.length);
            if (e.target.files && e.target.files.length > 0) {
                handleFiles(Array.from(e.target.files));
                e.target.value = '';
            }
        });
    }
    
    // Drag and drop handlers
    const dropZone = document.getElementById('file-drop-zone');
    if (dropZone) {
        dropZone.addEventListener('dragover', function(e) {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', function(e) {
            e.preventDefault();
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', function(e) {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        });
    }
}

// Tab switching
function switchTab(tabName) {
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    const navButtons = document.querySelectorAll('.nav-button');
    navButtons.forEach(btn => btn.classList.remove('active'));
    
    document.getElementById('tab-' + tabName).classList.add('active');
    document.getElementById('nav-' + tabName).classList.add('active');
}

// Handle file processing
async function handleFiles(files) {
    if (files.length === 0 || isProcessing) return;
    
    console.log('Processing', files.length, 'files...');
    isProcessing = true;
    showProcessing();
    
    try {
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const result = await processFile(file);
            healthData.push(result);
            
            const progress = Math.round(((i + 1) / files.length) * 100);
            updateProgress(progress);
        }
        
        saveHealthData();
        updateUI();
        switchTab('results');
        
    } catch (error) {
        console.error('Error processing files:', error);
    } finally {
        setTimeout(() => {
            hideProcessing();
            isProcessing = false;
        }, 500);
    }
}

// Process individual file
async function processFile(file) {
    return new Promise((resolve) => {
        setTimeout(() => {
            const metrics = {
                'Total Cholesterol': { value: Math.floor(Math.random() * 100) + 180, unit: 'mg/dL' },
                'LDL Cholesterol': { value: Math.floor(Math.random() * 60) + 70, unit: 'mg/dL' },
                'HDL Cholesterol': { value: Math.floor(Math.random() * 40) + 35, unit: 'mg/dL' },
                'Glucose': { value: Math.floor(Math.random() * 40) + 80, unit: 'mg/dL' }
            };
            
            resolve({
                fileName: file.name,
                uploadDate: new Date().toISOString(),
                metrics: metrics,
                insights: ['✅ Document processed successfully', '📊 Health metrics analyzed'],
                recommendations: ['Continue monitoring your health metrics', 'Maintain a balanced diet']
            });
        }, 1000);
    });
}

// Show processing UI
function showProcessing() {
    document.getElementById('upload-content').classList.add('hidden');
    document.getElementById('processing-content').classList.remove('hidden');
}

// Hide processing UI
function hideProcessing() {
    document.getElementById('upload-content').classList.remove('hidden');
    document.getElementById('processing-content').classList.add('hidden');
}

// Update progress bar
function updateProgress(progress) {
    document.getElementById('progress-bar').style.width = progress + '%';
    document.getElementById('progress-text').textContent = progress;
}

// Load health data from localStorage
function loadHealthData() {
    const saved = localStorage.getItem('healthAI_data');
    if (saved) {
        try {
            healthData = JSON.parse(saved);
        } catch (e) {
            healthData = [];
        }
    }
}

// Save health data to localStorage
function saveHealthData() {
    localStorage.setItem('healthAI_data', JSON.stringify(healthData));
    updateDocumentCount();
}

// Update document count
function updateDocumentCount() {
    const count = document.getElementById('doc-count');
    if (count) {
        count.textContent = healthData.length;
    }
}

// Update UI with current data
function updateUI() {
    updateResults();
    updateHistory();
}

// Update results tab
function updateResults() {
    if (healthData.length === 0) return;
    
    const latest = healthData[healthData.length - 1];
    document.getElementById('no-results').classList.add('hidden');
    document.getElementById('results-content').classList.remove('hidden');
    document.getElementById('results-content').innerHTML = `
        <div class="gradient-bg rounded-lg text-white p-6 mb-6">
            <h2 class="text-2xl font-bold mb-2">Health Analysis Complete</h2>
            <p>Document: ${latest.fileName}</p>
            <p class="text-sm opacity-75">Processed: ${new Date(latest.uploadDate).toLocaleString()}</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            ${Object.entries(latest.metrics).map(([name, data]) => `
                <div class="bg-white p-4 rounded-lg border metric-card">
                    <h4 class="font-semibold text-gray-900">${name}</h4>
                    <p class="text-2xl font-bold">${data.value} ${data.unit}</p>
                </div>
            `).join('')}
        </div>
    `;
}

// Update history tab
function updateHistory() {
    if (healthData.length === 0) return;
    
    document.getElementById('no-history').classList.add('hidden');
    document.getElementById('history-content').classList.remove('hidden');
    document.getElementById('history-content').innerHTML = `
        <div class="space-y-4">
            <h2 class="text-2xl font-bold">Document History</h2>
            ${healthData.map(doc => `
                <div class="bg-white p-6 rounded-lg border">
                    <h3 class="text-lg font-semibold">${doc.fileName}</h3>
                    <p class="text-sm text-gray-500">${new Date(doc.uploadDate).toLocaleString()}</p>
                    <div class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                        ${Object.entries(doc.metrics).map(([name, data]) => `
                            <div class="bg-gray-50 p-2 rounded">
                                <div class="font-medium">${name}</div>
                                <div>${data.value} ${data.unit}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}
</script>
